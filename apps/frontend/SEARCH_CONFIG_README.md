# 搜尋配置說明 - 假資料 + 真實API 模式

## 🎯 **當前配置策略**

為了節省API配額並避免資料庫連接問題，我們使用**混合模式**：

### ✅ **假資料模式 (租屋搜尋)**
- **資料來源**：本地 30筆台北地區測試資料
- **優點**：免費、快速、穩定
- **涵蓋範圍**：台北市、新北市、桃園市

### ✅ **真實API (等時線功能)**  
- **OpenRouteService API**：生成真實等時線範圍
- **Google Maps API**：(備用，通勤時間計算)
- **優點**：精確的地理範圍，考慮道路網絡

## 🔧 **配置文件**

### 前端 `apps/frontend/.env.local`
```bash
# Mapbox 地圖顯示
NEXT_PUBLIC_MAPBOX_API_KEY=pk.eyJ1Ijoia2VsdmluaG8xMDIwIiwiYSI6ImNtYWk4cmxlcTBiZDYya3B1Y2txdGczY3EifQ.4_nENcn
FOXRf54QTBqxChw

# 後端API連接
NEXT_PUBLIC_API_URL=http://localhost:8000/api

# 使用假資料模式（節省API配額）
NEXT_PUBLIC_USE_MOCK_DATA=true
```

### 後端 `apps/backend/.env`
```bash
# Google Maps API（等時線備用）
GOOGLE_MAPS_API_KEY=AIzaSyDh7J8-kb37h1_XcldmVtKEBz05eCbYsKo

# OpenRouteService API（等時線主要）
ORS_API_KEY=5b3ce3597851110001cf62488a936f5bbc834b9cb6eadc98115a7617
```

## 🎮 **使用方式**

### 手動觸發搜尋
- ✅ **點擊地圖**：選擇工作地點
- ✅ **調整條件**：價格、坪數、交通方式等
- ✅ **點擊搜尋按鈕**：才執行搜尋（節省API）
- ✅ **等時線自動生成**：使用真實API

### 不再自動觸發
- ❌ 改變交通方式不會立即搜尋
- ❌ 調整價格範圍不會立即搜尋  
- ❌ 修改距離不會立即搜尋

## 📊 **數據說明**

### 假資料特色
```json
{
  "總筆數": 30,
  "地理範圍": "台北市12區、新北市8區、桃園市2區",
  "價格範圍": "9,000 - 88,000元",
  "坪數範圍": "5.5 - 55.0坪",
  "通勤時間": "根據交通方式動態計算"
}
```

### 真實等時線
- **道路網絡**：考慮實際道路
- **交通方式**：driving、walking、transit
- **精確範圍**：不是簡單圓形
- **API配額**：每日2000次（ORS免費額度）

## 🔍 **測試方法**

1. **選擇工作地點**：在台北市區點選
2. **設定條件**：
   - 通勤時間：30分鐘
   - 交通方式：開車
   - 最大距離：5公里
   - 價格範圍：20,000-50,000
3. **點擊搜尋按鈕**
4. **查看結果**：
   - 假資料搜尋結果
   - 真實等時線範圍
   - Console日誌確認

## ⚡ **性能優化**

### API使用最小化
- **搜尋**：使用假資料，無API調用
- **等時線**：僅在選擇工作地點時調用一次
- **快取**：等時線結果會被快取

### 配額管理
- **ORS API**：每日2000次免費
- **Google Maps**：$100免費額度
- **Mapbox**：50,000次地圖載入免費

## 🚀 **預期效果**

- ✅ **即時可用**：不依賴資料庫
- ✅ **真實範圍**：等時線使用實際道路
- ✅ **節省配額**：只在必要時調用API
- ✅ **豐富測試**：30筆多樣化資料
- ✅ **開發友好**：快速響應，易於測試 